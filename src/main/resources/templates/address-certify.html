<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>동네 인증 | BizBeacon for Boss</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <!-- 내부 CSS -->
    <style>
        body {
            background-color: #e6f9f9; /* 페이지 배경 */
        }
        main {
            max-width: 600px;
        }
        .map-box {
            width: 100%;
            height: 700px;
            background: #e9ecef;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
            justify-content: left;
            border-radius: 6px;
        }
        .btn-certify {
            background-color: #198754; /* Bootstrap success 색상 */
            color: #fff;
            font-weight: bold;
        }
        .btn-certify:hover {
            background-color: #157347;
        }
        #map {
          justify-content: center;
          height:700px;
          width: 700px;
        }
    </style>
</head>
<body>


        <main class="container my-5">
            <h2 class="text-center mb-4">동네 인증</h2>

            <!--
    [동네 인증 처리 흐름 정리]

    1. 사용자가 주소를 입력하고 "내 동네 설정" 버튼을 누르면
       → 입력한 주소에 해당하는 위치가 지도에 표시됨
       → 이 시점에는 DB에 저장하지 않음

    2. 현재 사용자의 브라우저 위치 정보와 입력된 주소가 일치하는지 확인
       → 일치하면 "동네인증 완료하기" 버튼이 활성화됨

    3. 사용자가 "동네인증 완료하기" 버튼을 누르면
       → 해당 주소가 DB(User.address)에 저장됨
       → /restaurants 페이지(우리 동네 식당 리스트)로 이동
-->


    <!-- 주소 입력 -->
          <!--구조 변경으로인한 삭제 부분 이 버튼은 주소 검증을 위한 버튼-->
          <!--<form th:action="@{/api/users/address}" method="post">-->

        <div class="input-group mb-3">
            <input type="text" id="addressInput" name="address" class="form-control"
                   placeholder="예)서울특별시 종로구 회현동"
                   title="동/읍/면까지 입력해주세요" required>
            <button type="button" id ="addressSearchBtn" class="btn btn-outline-primary">내 동네 설정</button>

<!--      시큐리티 적용되고 동네인증 페이지 접속 부분 편집 필요
          <button type="button"
                  class="btn btn-outline-primary"
                  th:if="${user.address == null}">
            내 동네 설정
          </button>

          <button type="button"
                  class="btn btn-outline-primary"
                  th:if="${user.address != null}">
            내 동네 수정
          </button>-->


        </div>


    <!-- 지도 영역 -->
    <div class="mb-3 map-box">
        <!-- 나중에 Google Maps API로 대체 -->
        <h3>현재 위치로 동네 인증하기</h3>
        <div id="map"></div>
    </div>

    <!-- 현재 위치 표시 -->
    <p class="text-center">현재 위치는 <span id="ggaddress">서울특별시 종로구 회현동</span> 입니다.</p>
    <p class="text-center"><span id="result"></span> </p>


            <!-- 인증 완료 버튼 -->

          <form class="d-grid gap-2 mt-4" id="certifyForm">
             <input type="hidden" name="address" id="hiddenAddress">
             <button type="button" id="certifyBtn" class="btn btn-certify" disabled>동네인증 완료하기</button>
           </form>
         </main>

 <!-- Footer -->
<!--<div th:replace="partials/footer :: *"></div>-->
        <script th:inline="javascript">
          window.GOOGLE_MAPS_API_KEY = /*[[${apiKey}]]*/ 'DEFAULT_KEY';
        </script>
        <script src="/js/googlemap.js" type="module"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>
